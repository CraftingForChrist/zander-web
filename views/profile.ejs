<%- include("./partials/header.ejs") %>
<%- include("./partials/navigation.ejs") %>

<style media="screen">
  span {
    position: relative;
    display: inline-block;
  }
</style>

<div class="container">
  <% if (profileeditmode == true) { %>
  <form action="/profile/<%= playerresults.username %>/edit" method="POST">    
  <% } %>
  <div class="jumbotron jumbotron-image-header my-4 home-jumbo-header" style="height:340px; padding:25px;">
    <div class="container text-white">
      <img src="https://crafatar.com/avatars/<%= playerresults.uuid %>?overlay" height="150px" alt="<%= playerresults.username %>'s Player Head" draggable="false">
      <h3 class="display-4"><%= playerresults.username %></h3>

       <% playerrankresults.forEach(function (data) { %>
         <tr style="font-size:20pt">
           <% if (data.permission.includes('group.administrator')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.administrator %>">Administrator</span></th>
           <% } %>

           <% if (data.permission.includes('group.seniorstaff')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.seniorstaff %>">Senior Staff</span></th>
           <% } %>

           <% if (data.permission.includes('group.developer')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.developer %>">Developer</span></th>
           <% } %>

           <% if (data.permission.includes('group.juniordeveloper')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.juniordeveloper %>">Junior Developer</span></th>
           <% } %>

           <% if (data.permission.includes('group.staff')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.staff %>">Staff</span></th>
           <% } %>

           <% if (data.permission.includes('group.juniorstaff')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.juniorstaff %>">Junior Staff</span></th>
           <% } %>

           <% if (data.permission.includes('group.builder')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.builder %>">Builder</span></th>
           <% } %>

           <% if (data.permission.includes('group.eventstaff')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.eventstaff %>">Event Staff</span></th>
           <% } %>

           <% if (data.permission.includes('group.socialmedia')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.socialmedia %>">Social Media</span></th>
           <% } %>

           <% if (data.permission.includes('group.contentcreator')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.contentcreator %>">Content Creator</span></th>
           <% } %>

           <% if (data.permission.includes('group.retired')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.retired %>">Retired</span></th>
           <% } %>

           <% if (data.permission.includes('group.iron')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.iron %>">Iron</span></th>
           <% } %>

           <% if (data.permission.includes('group.gold')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.gold %>">Gold</span></th>
           <% } %>

           <% if (data.permission.includes('group.diamond')) { %>
             <th><span class="badge badge-secondary" style="background-color:<%= HexColour.diamond %>">Diamond</span></th>
           <% } %>
         </tr>
       <% }); %>

      <% if (playerresults.status == 'Online') { %>
        <p class="lead"><i class="fas fa-circle" style="color:green;"></i>  Currently Online on <%= currentserver %></p>
      <% } else { %>
        <p class="lead"><i class="fas fa-circle" style="color:red; height:40px;"></i>  Last Online on <%= currentserver %></p>
      <% } %>

      <% if (bedrockuser == true) { %>
        <p><span class="badge badge-secondary">Bedrock</span></p>
      <% } %>
    </div>
  </div>

  <div class="alert alert-warning" role="alert">
    Profiles are still a work in progress, if you see something working incorrectly report it to our Developers <a href="/issues">here</a>.
  </div>

  <div class="row">
    <div class="col-lg-8 col-md-6 mb-4">
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="about-tab" data-toggle="tab" href="#about" role="tab" aria-controls="about" aria-selected="false">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="stats-tab" data-toggle="tab" href="#stats" role="tab" aria-controls="stats" aria-selected="true">Statistics</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="punishments-tab" data-toggle="tab" href="#punishments" role="tab" aria-controls="contact" aria-selected="false">Punishments</a>
        </li>
      </ul>

      <div class="tab-content" id="myTabContent">
        <!--
          About Tab
        -->
        <div class="tab-pane fade show active" id="about" role="tabpanel" aria-labelledby="about-tab">
          <br>
          <div class="alert alert-primary" role="alert">
            <b>Coming Soon <i class="fas fa-trademark"></i></b><br>Here you should be able to create your own about page and add things, your own creative space!
          </div>
          <p>This is where the users about custom information will go.</p>
        </div>

        <!--
          Statistics Tab
        -->
        <div class="tab-pane fade" id="stats" role="tabpanel" aria-labelledby="stats-tab">
          <% if (tgmresbool == true) { %>
            <div class="card card-home">
              <table class="table table-borderless">
                <tr>
                  <td>Kills</td>
                  <td>Deaths</td>
                  <td>Wins</td>
                  <td>Losses</td>
                </tr>

                <tr>
                  <td class="profilenumber"><%= tgmres.user.kills %></td>
                  <td class="profilenumber"><%= tgmres.user.deaths %></td>
                  <td class="profilenumber"><%= tgmres.user.wins %></td>
                  <td class="profilenumber"><%= tgmres.user.losses %></td>
                </tr>

                <tr>
                  <td>Matches Played</td>
                  <td>Wools Destroyed</td>
                  <td>Level</td>
                  <td>W/L</td>
                  <td>K/D</td>
                </tr>

                <tr>
                  <td class="profilenumber"><%= tgmres.user.matches %></td>
                  <td class="profilenumber"><%= tgmres.user.wool_destroys %></td>
                  <td class="profilenumber"><%= tgmres.user.level %></td>
                  <td class="profilenumber"><%= winlossratio %></td>
                  <td class="profilenumber"><%= killdeathratio %></td>
                </tr>
              </table>
            </div>
          <% } else { %>
            <div class="alert alert-warning" role="alert">
              <%= playerresults.username %> has not played on Mixed, can't display their statistics.
            </div>
          <% } %>
        </div>

        <!--
          Punishments Tab
        -->
        <div class="tab-pane fade" id="punishments" role="tabpanel" aria-labelledby="punishments-tab">
          <% if (punishmentresults.length > 0) { %>
            <div class="card card-home">
              <table class="table table-borderless">
                <thead>
                  <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Punished</th>
                    <th scope="col">Punisher</th>
                    <th scope="col">Reason</th>
                    <th scope="col">Type</th>
                    <% if (isProfileUser == true) { %>
                      <th scope="col">Action</th>
                    <% } %>
                  </tr>
                </thead>
              <% punishmentresults.forEach(function (data) { %>
                <tbody>
                  <tr>
                    <td>#<%= data.id %></td>
                    <td><a href="<%= data.username %>"><%= data.name %></a></td>
                    <td><a href="<%= data.operator %>"><%= data.operator %></a></td>
                    <td><%= data.reason %></td>
                    <!-- Format with Badges, Punishment Types -->
                    <% if (data.punishmentType == "WARNING") { %>
                      <td><span class="punishmenttypebadge badge bg-warning">WARNING</span></td>
                    <% } %>

                    <% if (data.punishmentType == "KICK") { %>
                      <td><span class="punishmenttypebadge badge bg-primary">KICK</span></td>
                    <% } %>

                    <% if (data.punishmentType == "TEMP_BAN") { %>
                      <td><span class="punishmenttypebadge badge bg-info">TEMP BAN</span></td>
                    <% } %>

                    <% if (data.punishmentType == "BAN") { %>
                      <td><span class="punishmenttypebadge badge bg-danger">BAN</span></td>
                    <% } %>

                    <% if (isProfileUser == true) { %>
                      <td>
                        <form action="">
                          <input type="hidden" name="punishment-id" value="<%= data.id %>">
                          <button type="button" class="btn btn-danger btn-sm">Appeal</button>
                        </form>
                      </td>
                    <% } %>
                  </tr>
                </tbody>
              <% }) %>
            </table>
          </div>
          <% } else { %>
            <div class="alert alert-warning" role="alert">
              <%= playerresults.username %> has no punishments on record.
            </div>
          <% } %>
        </div>
      </div>
    </div>

    <!--
      Information Sidebar
    -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card card-home">
        <div class="card-body">
          <h4 class="card-title">Information</h4>
            <p>Joined: <%= initjoindate %></p>

          <div class="alert alert-primary" role="alert">
            <b>Coming Soon <i class="fas fa-trademark"></i></b><br>Allow people to stay in contact with you by sharing your Social handles.
          </div>

          <!--
            Interests
          -->
          <% if (playerprofileresults.interests || profileeditmode == true) { %>
            <h4 class="card-title">Interests</h4>
            <% if (profileeditmode == true) { %>
              <textarea name="interest" cols="40" rows="5"><%= playerprofileresults.interests %></textarea>
            <% } else { %>
              <p><%= playerprofileresults.interests %></p>
            <% } %>
            <hr>            
          <% }  %>

          <!--
            Social Media Handles Sidebar Aspect
            Currently static but will be dynamic later.
          -->
          <h4 class="card-title">Social Media</h4>
            <table class="table table-borderless">
              <% if (playerprofileresults.twitter || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-twitter"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-twitter" value="<%= playerprofileresults.twitter %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.twitter %></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.twitch || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-twitch"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-twitch" value="<%= playerprofileresults.twitch %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.twitch %></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.youtube || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-youtube"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-youtube" value="<%= playerprofileresults.youtube %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.youtube%></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.instagram || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-instagram"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-instagram" value="<%= playerprofileresults.instagram %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.instagram %></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.steam || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-steam-symbol"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-steam" value="<%= playerprofileresults.steam %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.steam %></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.github || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-github"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-github" value="<%= playerprofileresults.github %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.github %></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.snapchat || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-snapchat-ghost"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-snapchat" value="<%= playerprofileresults.snapchat %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.snapchat%></a></th>
                  <% } %>
                </tr>
              <% } %>

              <% if (playerprofileresults.discord || profileeditmode == true) { %>
                <tr>
                  <th class="socialmediaicon-profile"><h3><i class="fab fa-discord"></i></h3></th>
                  <% if (profileeditmode == true) { %>
                    <th><input type="text" name="sm-discord" value="<%= playerprofileresults.discord %>"></th>
                  <% } else { %>
                    <th><a href=""><%= playerprofileresults.discord %></a></th>
                  <% } %>
                </tr>
              <% } %>
            </table>
            <hr>

          <!--
            Friends
            Currently not implemented, but hope that someone will find this and report it to a Developer to implement it.
          -->
          <!-- <h4 class="card-title">Friends <span class="badge bg-primary" style="color:white; font-size: 9pt;">100</span></h4>
          <hr> -->
        </div>
      </div>
    </div>
  </div>

  
  <% if (profileeditmode == true) { %>
    <button type="submit" class="btn btn-primary"">Update Profile</button>
    <br><br>
  <% } %>

<% if (profileeditmode == true) { %>
</form>    
<% } %>
</div>

<%- include("./partials/footer.ejs") %>
